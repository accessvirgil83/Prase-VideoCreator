Option Explicit

' ??????? ??? ???????????? ?????????
Dim venvName
venvName = "rs"

' ?????????, ??? Python ??????????
Dim shell, pythonCheck
Set shell = CreateObject("WScript.Shell")

On Error Resume Next
pythonCheck = shell.Exec("python --version").StdOut.ReadAll()
On Error GoTo 0

If pythonCheck = "" Then
    WScript.Echo "??????: Python ?? ??????????. ??????????, ?????????? Python ????? ???????? ????? ???????."
    WScript.Quit
End If

WScript.Echo "Python ??? ??????????. ??????: " & pythonCheck

' ???????? ???????????? ?????????
WScript.Echo "???????? ???????????? ????????? '" & venvName & "'..."
shell.Run "python -m venv " & venvName, 1, True

' ???????? ??????? ????? requirements.txt ? ????????? ????????????
Dim fso, requirementsPath
Set fso = CreateObject("Scripting.FileSystemObject")
requirementsPath = "requirements.txt"

If fso.FileExists(requirementsPath) Then
    WScript.Echo "????????? ???????????? ?? " & requirementsPath & "..."
    shell.Run venvName & "\Scripts\activate.bat & pip install -r requirements.txt", 1, True
Else
    WScript.Echo "File requirements.txt not found"
End If

WScript.Echo "??????? ????????."

' ???????????? ????????
Set fso = Nothing
Set shell = Nothing